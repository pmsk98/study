for(v in V(g)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
else if(v %in% between[[5]]) colors<-c(colors,'green')
else if(v %in% between[[6]]) colors<-c(colors,'pink')
else if(v %in% between[[7]]) colors<-c(colors,'black')
}
plot(g,vertex.size=5,vertex.color=colors)
g1 <-graph.data.frame(table2[151:333,],directed = F)
between <-edge.betweenness.community(g1)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g1)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
else if(v %in% between[[5]]) colors<-c(colors,'green')
else if(v %in% between[[6]]) colors<-c(colors,'pink')
else if(v %in% between[[7]]) colors<-c(colors,'black')
else if(v %in% between[[8]]) colors<-c(colors,'gray')
else if(v %in% between[[9]]) colors<-c(colors,'purple')
else if(v %in% between[[10]]) colors<-c(colors,'cyan')
}
plot(g1,vertex.size=5,vertex.color=colors)
#네트워크 수준 분석
which.max(degree(g))
which.max(betweenness(g))
which.max(closeness(g))
which.max(eigen_centrality(g)$vector)
plot(g,vertex.size=5,vertex.color=colors)
#table3
g <-graph.data.frame(table3[1:150,],directed=F)
#네트워크 커뮤니티 탐지
between <-edge.betweenness.community(g)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
}
plot(g,vertex.size=5,vertex.color=colors)
g1 <-graph.data.frame(table3[151:333,],directed=F)
between <-edge.betweenness.community(g1)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g1)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
}
plot(g1,vertex.size=5,vertex.color=colors)
#table4
g <-graph.data.frame(table4[1:150,],directed = F)
#네트워크 커뮤니티 탐지
between <-edge.betweenness.community(g)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
}
plot(g,vertex.size=5,vertex.color=colors)
g1 <-graph.data.frame(table4[151:333,],directed = F)
between <-edge.betweenness.community(g1)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g1)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
}
plot(g1,vertex.size=5,vertex.color=colors)
#table5
g <-graph.data.frame(table5[1:150,],directed = F)
#네트워크 커뮤니티 탐지
between <-edge.betweenness.community(g)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
}
plot(g,vertex.size=5,vertex.color=colors)
g1 <-graph.data.frame(table5[151:333,],directed = F)
between <-edge.betweenness.community(g1)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g1)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
}
plot(g1,vertex.size=5,vertex.color=colors)
table6
g <-graph.data.frame(table6[1:150,],directed=F)
#네트워크 커뮤니티 탐지
between <-edge.betweenness.community(g)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
else if(v %in% between[[5]]) colors<-c(colors,'green')
else if(v %in% between[[6]]) colors<-c(colors,'pink')
}
plot(g,vertex.size=5,vertex.color=colors)
g1 <-graph.data.frame(table6[151:333,],directed = F)
between <-edge.betweenness.community(g1)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g1)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
else if(v %in% between[[5]]) colors<-c(colors,'green')
}
plot(g1,vertex.size=5,vertex.color=colors)
table7
g <-graph.data.frame(table7[1:150,],directed = F)
#네트워크 커뮤니티 탐지
between <-edge.betweenness.community(g)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
else if(v %in% between[[5]]) colors<-c(colors,'green')
else if(v %in% between[[6]]) colors<-c(colors,'pink')
else if(v %in% between[[7]]) colors<-c(colors,'black')
else if(v %in% between[[8]]) colors<-c(colors,'gray')
else if(v %in% between[[9]]) colors<-c(colors,'purple')
else if(v %in% between[[10]]) colors<-c(colors,'cyan')
else if(v %in% between[[11]]) colors<-c(colors,'beige')
else if(v %in% between[[12]]) colors<-c(colors,'aquamarine')
else if(v %in% between[[13]]) colors <-c(colors,'antiquewhite4')
else if(v %in% between[[14]]) colors <-c(colors,'darkgoldenrod')
else if(v %in% between[[15]]) colors <-c(colors,'darkblue')
}
plot(g,vertex.size=5,vertex.color=colors)
g1 <-graph.data.frame(table7[151:333,],directed = F)
between <-edge.betweenness.community(g1)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g1)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
else if(v %in% between[[5]]) colors<-c(colors,'green')
else if(v %in% between[[6]]) colors<-c(colors,'pink')
else if(v %in% between[[7]]) colors<-c(colors,'black')
else if(v %in% between[[8]]) colors<-c(colors,'gray')
else if(v %in% between[[9]]) colors<-c(colors,'purple')
else if(v %in% between[[10]]) colors<-c(colors,'cyan')
else if(v %in% between[[11]]) colors<-c(colors,'beige')
else if(v %in% between[[12]]) colors<-c(colors,'aquamarine')
else if(v %in% between[[13]]) colors <-c(colors,'antiquewhite4')
else if(v %in% between[[14]]) colors <-c(colors,'darkgoldenrod')
else if(v %in% between[[15]]) colors <-c(colors,'darkblue')
else if(v %in% between[[16]]) colors <-c(colors,'bisque')
else if(v %in% between[[17]]) colors <-c(colors,'SteelBlue')
else if(v %in% between[[18]]) colors <-c(colors,'DeepPink')
}
plot(g1,vertex.size=5,vertex.color=colors)
#0.8~1
g <-graph.data.frame(table8,directed = F)
#네트워크 커뮤니티 탐지
between <-edge.betweenness.community(g)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
else if(v %in% between[[5]]) colors<-c(colors,'green')
else if(v %in% between[[6]]) colors<-c(colors,'pink')
else if(v %in% between[[7]]) colors<-c(colors,'black')
else if(v %in% between[[8]]) colors<-c(colors,'gray')
}
plot(g,vertex.size=5,vertex.color=colors)
#네트워크 수준 분석
which.max(degree(g))
which.max(betweenness(g))
which.max(closeness(g))
which.max(eigen_centrality(g)$vector)
#table2
g <-graph.data.frame(table2[1:150,],directed=F)
#네트워크 수준 분석
which.max(degree(g))
which.max(betweenness(g))
which.max(closeness(g))
which.max(eigen_centrality(g)$vector)
g1 <-graph.data.frame(table2[151:333,],directed = F)
which.max(degree(g1))
which.max(betweenness(g1))
which.max(closeness(g1))
which.max(eigen_centrality(g1)$vector)
plot(g1,vertex.size=5,vertex.color=colors)
g1 <-graph.data.frame(table2[151:333,],directed = F)
between <-edge.betweenness.community(g1)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g1)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
else if(v %in% between[[5]]) colors<-c(colors,'green')
else if(v %in% between[[6]]) colors<-c(colors,'pink')
else if(v %in% between[[7]]) colors<-c(colors,'black')
else if(v %in% between[[8]]) colors<-c(colors,'gray')
else if(v %in% between[[9]]) colors<-c(colors,'purple')
else if(v %in% between[[10]]) colors<-c(colors,'cyan')
}
plot(g1,vertex.size=5,vertex.color=colors)
result
#table3
g <-graph.data.frame(table3[1:150,],directed=F)
#네트워크 수준 분석
which.max(degree(g))
which.max(betweenness(g))
which.max(closeness(g))
which.max(eigen_centrality(g)$vector)
g1 <-graph.data.frame(table3[151:333,],directed=F)
which.max(degree(g1))
which.max(betweenness(g1))
which.max(closeness(g1))
which.max(eigen_centrality(g1)$vector)
#table4
g <-graph.data.frame(table4[1:150,],directed = F)
#네트워크 커뮤니티 탐지
between <-edge.betweenness.community(g)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
}
plot(g,vertex.size=5,vertex.color=colors)
which.max(degree(g))
which.max(betweenness(g))
which.max(closeness(g))
which.max(eigen_centrality(g)$vector)
#table4
g <-graph.data.frame(table4[1:150,],directed = F)
g
table4[1:150,]
#table4
g <-graph.data.frame(table4[1:150,],directed = F)
#네트워크 커뮤니티 탐지
between <-edge.betweenness.community(g)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
}
plot(g,vertex.size=5,vertex.color=colors)
which.max(degree(g))
which.max(betweenness(g))
which.max(closeness(g))
which.max(eigen_centrality(g)$vector)
g1 <-graph.data.frame(table4[151:333,],directed = F)
between <-edge.betweenness.community(g1)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g1)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
}
which.max(degree(g1))
which.max(betweenness(g1))
which.max(closeness(g1))
which.max(eigen_centrality(g1)$vector)
#table5
g <-graph.data.frame(table5[1:150,],directed = F)
#네트워크 커뮤니티 탐지
between <-edge.betweenness.community(g)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
}
which.max(degree(g))
which.max(betweenness(g))
which.max(closeness(g))
which.max(eigen_centrality(g)$vector)
g1 <-graph.data.frame(table5[151:333,],directed = F)
between <-edge.betweenness.community(g1)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g1)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
}
which.max(degree(g1))
which.max(betweenness(g1))
which.max(closeness(g1))
which.max(eigen_centrality(g1)$vector)
g <-graph.data.frame(table6[1:150,],directed=F)
#네트워크 커뮤니티 탐지
between <-edge.betweenness.community(g)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
else if(v %in% between[[5]]) colors<-c(colors,'green')
else if(v %in% between[[6]]) colors<-c(colors,'pink')
}
which.max(degree(g))
which.max(betweenness(g))
which.max(closeness(g))
which.max(eigen_centrality(g)$vector)
g1 <-graph.data.frame(table6[151:333,],directed = F)
between <-edge.betweenness.community(g1)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g1)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
else if(v %in% between[[5]]) colors<-c(colors,'green')
}
which.max(degree(g1))
which.max(betweenness(g1))
which.max(closeness(g1))
which.max(eigen_centrality(g1)$vector)
table7
g <-graph.data.frame(table7[1:150,],directed = F)
#네트워크 커뮤니티 탐지
between <-edge.betweenness.community(g)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
else if(v %in% between[[5]]) colors<-c(colors,'green')
else if(v %in% between[[6]]) colors<-c(colors,'pink')
else if(v %in% between[[7]]) colors<-c(colors,'black')
else if(v %in% between[[8]]) colors<-c(colors,'gray')
else if(v %in% between[[9]]) colors<-c(colors,'purple')
else if(v %in% between[[10]]) colors<-c(colors,'cyan')
else if(v %in% between[[11]]) colors<-c(colors,'beige')
else if(v %in% between[[12]]) colors<-c(colors,'aquamarine')
else if(v %in% between[[13]]) colors <-c(colors,'antiquewhite4')
else if(v %in% between[[14]]) colors <-c(colors,'darkgoldenrod')
else if(v %in% between[[15]]) colors <-c(colors,'darkblue')
}
which.max(degree(g))
which.max(betweenness(g))
which.max(closeness(g))
which.max(eigen_centrality(g)$vector)
corr
which.max(degree(g))
which.max(betweenness(g))
which.max(closeness(g))
which.max(eigen_centrality(g)$vector)
result
g1 <-graph.data.frame(table7[151:333,],directed = F)
between <-edge.betweenness.community(g1)
result <-data.frame()
for (i in 1:length(between)){
result <-rbind(result,data.frame(group=i,size=length(between[[i]])))
}
result
colors <-c()
for(v in V(g1)$name){
if(v %in% between[[1]]) colors <-c(colors,'red')
else if(v %in% between[[2]]) colors<-c(colors,'blue')
else if(v %in% between[[3]]) colors<-c(colors,'yellow')
else if(v %in% between[[4]]) colors<-c(colors,'orange')
else if(v %in% between[[5]]) colors<-c(colors,'green')
else if(v %in% between[[6]]) colors<-c(colors,'pink')
else if(v %in% between[[7]]) colors<-c(colors,'black')
else if(v %in% between[[8]]) colors<-c(colors,'gray')
else if(v %in% between[[9]]) colors<-c(colors,'purple')
else if(v %in% between[[10]]) colors<-c(colors,'cyan')
else if(v %in% between[[11]]) colors<-c(colors,'beige')
else if(v %in% between[[12]]) colors<-c(colors,'aquamarine')
else if(v %in% between[[13]]) colors <-c(colors,'antiquewhite4')
else if(v %in% between[[14]]) colors <-c(colors,'darkgoldenrod')
else if(v %in% between[[15]]) colors <-c(colors,'darkblue')
else if(v %in% between[[16]]) colors <-c(colors,'bisque')
else if(v %in% between[[17]]) colors <-c(colors,'SteelBlue')
else if(v %in% between[[18]]) colors <-c(colors,'DeepPink')
}
which.max(degree(g1))
which.max(betweenness(g1))
which.max(closeness(g1))
which.max(eigen_centrality(g1)$vector)
#0.8~1
g <-graph.data.frame(table8,directed = F)
result
#최종결과물 작성
corr_result
write.csv(corr_result,"종목간의 수익률 상관계수.csv")
write.csv(table1,"상관계수 -0.6~-0.2 종목.csv")
write.csv(table2,"상관계수 -0.2~0.0 종목.csv")
write.csv(table3,"상관계수 0.0~0.2 종목.csv")
write.csv(table4,"상관계수 0.2~0.4 종목.csv")
write.csv(table5,"상관계수 0.4~0.6 종목.csv")
write.csv(table6,"상관계수 0.6~0.8 종목.csv")
write.csv(table7,"상관계수 0.8~1.0 종목.csv")
